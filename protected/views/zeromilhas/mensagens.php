<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="author" content="Bombarco - Líder em Negócios Náuticos" />
  <meta name="keywords" content="bombarco, zeromilhas, nautico, lider, marinha" />
          <meta name="geo.region" content="BR-SP" />
        <meta name="geo.placename" content="Brasil" />
        <meta name="geo.position" content="-14.2392976,-53.1805017,4z" />
        <meta name="ICBM" content="-14.2392976,-53.1805017,4z" />
        <meta name="robots" content="follow,index" />
  <link rel="shortcut icon" href="/favicon.ico?e=23" />
  <title>Catálogo Bombarco | Planos</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no" />
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/bootstrap.min.css?e=2333'); ?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/fancybox.css?e=23'); ?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/fancybox-buttons.css?e545');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/font-awesome.min.css?e1');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/tether.min.css?1212');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/reset.css');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/bjqs.css?e=234');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/style.css?e=22223');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/responsive.css?e=3333f');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/jquery-ui.css?e=234');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/datatable.css?e=23');?>

  

  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/modernizr.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery-3.2.1.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/tether.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/bootstrap.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/counter.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/numeral.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/fancybox.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/fancybox-buttons.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery.ez-plus.js?e=2344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery-ui.js?e=1111', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/owl.carousel.min.js?e=1344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/bjqs.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/maskedinput.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/bootstrap-slider.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/modernizr.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/scripts.js?e=123', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/vue-2.5.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/axios-0.17.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery.lightbox_me.js', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/jquery-mask.js', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/datatable.min.js?e=23', CClientScript::POS_END); ?>


  

<!-- Permite que o IE interprete as tags do HTML 5 -->
<!--[if lt IE 9]>
<script src="media/http://html5shim.googlecode.com/svn/trunk/html5.js?e=344"></script>
<link rel="stylesheet" type="text/css" href="http://domain.tld/path/ie-specific.css" />
<![endif]-->

<!--Fonts-->
<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,600,800,900" rel="stylesheet">

    <?php
        $this->renderPartial('analytics');
    ?>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <style>
        .tr-msgs {
            background-color: rgba(0,0,0,0) !important;
        }

    </style>

</head> <!-- FIM HEAD -->

<body id="topo" class="side-collapse-container">

    <div id="app">

   <?php
        $this->renderPartial('_menu');
    ?>

      <section id="titulo-subpagina">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 col-sm-12">
          <h1>
            Mensagens
            <img src="<?php echo Yii::app()->baseUrl . '/img_zeromilhas/icones/ico_titulo.png'?>" alt="Titulo" />
          </h1>
          <p>Responda rapidamente e aumente as chances de fechar negócio.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Miolo -->
  <section id="miolo">
    <div class="container">
      <div class="row">

        <div class="col-lg-12 col-sm12">
             <ul class="nav nav-pills mb-3" id="menu-tabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link" id="perfil-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/perfil", array("id"=>Yii::app()->user->id)); ?>" aria-controls="tab-perfil" aria-selected="true">Perfil</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="embarcacoes-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/planos"); ?>" aria-controls="tab-embarcacoes" aria-selected="false">Meus Modelos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="embarcacoes-tab" href="<?php echo Yii::app()->createUrl("embarcacoes/lista?v=0&e=anuncios"); ?>" aria-controls="tab-embarcacoes" aria-selected="false"> Classificados</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="dashboard-tab" href="<?php echo Yii::app()->createUrl("dashboard"); ?>" aria-controls="tab-dashboard" aria-selected="false">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" id="mensagens-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/mensagens"); ?>" aria-controls="tab-mensagens" aria-selected="false">Mensagens</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="mensagens-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/pagamento"); ?>" aria-controls="tab-mensagens" aria-selected="false">Pagamentos</a>
            </li>
          </ul>
        </div>

        <div class="barra-titulo filtros">
          <div class="col-lg-12 col-sm-12">

            <h4 class="com-barra">Você tem <b><?php echo $count_novas; ?> novas mensagens</b></h4>
          </div>
        </div>

        <div class="col-lg-12 col-sm-12">
          <table id="tabela" class="table table-striped striped-2 tabela-mensagens w-100 ajusta-tabela">
            <thead>
              <tr>
                <th>Data</th>
                <th>Anúncio</th>
                <th>Mensagem</th>
                <!--<th></th>-->
              </tr>
            </thead>
            <tbody>
                <?php foreach($msgs as $msg) :?>

                    <?php if($msg["status"] == 1 && (Yii::app()->user->id != $msg['usuarios_id_rem'])): ?>
                        <?php $classe = "tr-msgs msg-nao-lida"; ?>
                    <?php else: ?>
                        <?php $classe = "tr-msgs msg-lida"; ?>
                    <?php endif; ?>

                    <?php if($msg["embarcacoes_id"] != null): ?>
                    <?php $emb = Embarcacoes::model()->findByPk($msg["embarcacoes_id"]); ?>
                    <?php if($msg['usuarios_id_rem'] == Yii::app()->user->id) :?>
                        <?php $msg['usuarios_id_rem'] = $msg['usuarios_id_dest']; ?>
                    <?php endif; ?>

                    <tr class="<?php echo $classe;?>" data-msgid="<?php echo $msg['id'];?>" data-embarcacoes_id="<?php echo $emb->id; ?>" data-usuarios_id_rem="<?php echo $msg['usuarios_id_rem']; ?>" style="cursor: pointer;">
                        <td><?php echo Utils::formatDateTimeToView($msg['data']); ?></td>
                            <td>
                                <?php echo Embarcacoes::getAlt($emb); ?>
                                <?php if($emb->valor != 0.00): ?>
                                    <br/>
                                    <span>R$ <?php echo Utils::formataValorView((float) $emb->valor);?></span>
                                <?php endif; ?>
                            </td>
                        <?php endif; ?>
                        <td>
                            <p class="w-80"><?php echo $msg["titulo_mensagem"]; ?></p><?php echo $msg["email_rem"]; ?>
                        </td>
                    </tr>
                <?php endforeach; ?>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </section>


            <div class="modal fade" id="mensagem01" tabindex="-1" role="dialog" aria-labelledby="popupLogin" aria-hidden="true">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="popupLogin"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <span class="titulo-modal">Mensagem</span>
                    <div class="limita-mensagens" id="div-conversa">
                    </div>
                    <div class="row"><hr/></div>
                    <span class="titulo-modal">Sua resposta</span>
                    <textarea id="msg">Digite aqui sua resposta.</textarea>
                  </div>
                  <div class="modal-footer">
                    <a href="#" @click.stop.prevent="enviarMsg($event)" class="btn btn-verde-claro w-65"><span class="pull-left">Enviar </span><i class="fa fa-check"></i></a>
                  </div>
                </div>
              </div>
            </div>
            <a href="#topo" class="volta-topo" title="Topo"><i class="fa fa-angle-up"></i></a>
            <?php echo CHtml::hiddenField('email', Usuarios::getUsuarioLogado()->email, array('id' => 'email-logado')); ?>


            <input type="hidden" id="hidden_embarcacoes_id"/>
            <input type="hidden" id="hidden_id_usuario_dest"/>
            <input type="hidden" id="hidden_msgid"/>

</body>



    <script>

        $(document).ready(function() {
        	
        	$(".msg-nao-lida td").each(function() {
        		$(this).css("font-weight", "bold");
        		$(this).find("p").css("font-weight", "bold");
        		$(this).find("span").css("font-weight", "bold");
        	});

            var tabela = $('#tabela').DataTable({
                pageLength: 50,
                lengthChange: false,
                "language": {
                    "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Portuguese.json"
                }
            });

            $(".tr-msgs").on("click", function(e) {

                var $this = $(this);

                $("#hidden_embarcacoes_id").val($this.data("embarcacoes_id"));
                $("#hidden_id_usuario_dest").val($this.data("usuarios_id_rem"));
                $("#hidden_msgid").val($this.data("msgid"));

                $.ajax({
                    url: Yii.app.createUrl("zeromilhas/abrirConversa"),
                    type: "GET",
                    data: {
                        usuarios_id_rem: $this.data("usuarios_id_rem"),
                        embarcacoes_id: $this.data("embarcacoes_id"),
                        msg_id: $this.data("msgid")
                    },
                    success: function(resp) {
                        
                        let msgs = JSON.parse(resp);

                        $("#div-conversa").empty();

                        for(var i = 0; i < msgs.length; i++) {

                            let horario = msgs[i].data.split(" ")[1];
                            let data = msgs[i].data.split(" ")[0].split("-");
                            let dia = data[2];
                            let mes = data[1];
                            let ano = data[0];
                            data = dia + "/" + mes + "/" + ano + " " + " às " + horario;

                            let p = "<p>"+msgs[i].mensagem+"</p>";
                            let span = "<span class='autor-modal'>"+msgs[i].email_rem+"</span> <small>"+data+"</small>";
                            let div = "<div class='row'><hr/></div>";
                            $("#div-conversa").append(p);
                            $("#div-conversa").append(span);
                            $("#div-conversa").append(div);

                        }
                        $("#mensagem01").modal();

                        $(".msg-nao-lida td").each(function() {
			        		$(this).css("font-weight", "normal");
			        		$(this).find("p").css("font-weight", "normal");
			        		$(this).find("span").css("font-weight", "normal");
			        	});
                    },
                    error: function() {

                    } 
                });
            }); 
        });
        
        var perfil = new Vue({ 
            delimiters: ['${', '}'],
            el: "#app",
            data: {
                emailnews: "",
                msgs: [],

                id_embarcacao: "",
                id_usuario_dest: "",
                id_msg_cima: ""
            },
            created: function() {

            },

            mounted: function() {

            },
            methods: {
                enviarMsg: function() {

                    const $this = this;

                    ga('send', 'event', 'link', 'click', 'Enviar Mensagem');

                    $.ajax({
                        url: Yii.app.createUrl("zeromilhas/enviarMsg"),
                        type: "POST",
                        data: {
                            id_embarcacao: $("#hidden_embarcacoes_id").val(),
                            id_usuario_dest: $("#hidden_id_usuario_dest").val(),
                            id_msg_cima: $("#hidden_msgid").val(),
                            msg: $("#msg").val()
                        },
                        success: function(resp) {
                            if(resp.trim() == "1") {

                                let arr_msgs = [];
                                arr_msgs.push({mensagem: $("#msg").val(), email_rem: $("#email-logado").val()});
                                arr_msgs = arr_msgs.concat($this.msgs); 
                                $this.msgs = arr_msgs;

                                alert("Mensagem enviada com sucesso!");
                                location.reload();
                            }
                        },
                        error: function() {
                            alert("Erro inesperado. Contate o admin do sistema");
                        }
                    });

                    // pega o tipo da mensagem no campo hidden (E - empresa/estaleiro, X - anuncio)
                    /*var tipo = $("#tipo").val();

                    var nome = $("#nome-contato-anunciante").val();
                    var nome_destinatario = $("#nome-contato").val();
                    var email_remetente = $("#email-contato-anunciante").val();
                    var telefone = $("#telefone-contato-anunciante").val();
                    var mensagem = $("#mensagem-contato-anunciante").val();
                    var j8BSVuvy = $(".j8BSVuvy").val();
                    var idUsuarioDonoEmbarc = $("#idUsuarioDonoEmbarc").val();


                    $.ajax({
                        url: url,
                        async: false,
                        data: {
                            nome_rem: nome,
                            nome_destinatario: nome_destinatario,
                            email_remetente: email_remetente,
                            telefone_rem: telefone,
                            mensagem: mensagem,
                            idUsuarioDonoEmbarc: idUsuarioDonoEmbarc,
                            idEmbarcacao: $("#idEmbarcacao").val(),
                            emailEmbarcacao: $("#emailEmbarcacao").val(),
                            resposta: 1,
                            partner_trans: 0,
                            partner_finan: 0,
                            partner_cons: 0,
                            partner_marina: 0,
                            j8BSVuvy: j8BSVuvy
                        },
                        type: 'POST',
                        success: function (resp) {

                            if (resp.trim() == '-3') {
                                $("#lbox-detemba .ev-titleb").text("Detectamos seu cadastro, digite sua senha");
                                $("#lbox-detemba .email-contato-anunciante").hide();
                                $("#lbox-detemba .nome-contato-anunciante").hide();
                                $("#lbox-detemba .telefone-contato-anunciante").hide();
                                $("#lbox-detemba .mensagem-contato-anunciante").hide();
                                $("#lbox-detemba .senha-contato-anunciante").show();
                                return false;
                            }

                            if (resp.trim() == '-5') {
                                lightBoxMsg("Não é possível enviar uma mensagem a si mesmo");
                                return false;
                            }

                            if (resp.trim() == '-7') {
                                lightBoxMsg("Senha inválida");
                                return false;
                            }

                            if (resp.trim() == '2') {
                                lightBoxMsgSucessoReload("Mensagem enviada com sucesso!");
                                $('#close-form-contato').trigger("click");
                                return false;
                            }

                            if (resp.trim() != '-1') {

                                if ($("#resposta").val() == 0) {

                                    lightBoxMsgSucesso("Mensagem enviada com sucesso!");
                                    $('#close-form-contato').trigger("click");

                                } else {

                                    var nome = $("#nome-contato-anunciante").val();
                                    var data = $("#data").val();

                                    var mensagem = $("#mensagem-contato-anunciante").val();

                                    var div = $('<div class="mensagem-individual-resposta"><span class="resposta-autor"><b>' + nome + '</b> ' + data + '</span><p>' + mensagem + '</p></div>');
                                    $("#div-mensagens").prepend(div).trigger("create");

                                    $("#mensagem-contato-anunciante").val("");
                                }

                            } else {
                                lightBoxMsg("Ocorreu um erro inesperado. Tente novamente mais tarde");
                            }
                        },
                        error: function (x, h, err) {
                            
                            lightBoxMsg("Ocorreu um erro inesperado. Tente novamente mais tarde");
                        }
                    });*/
                },
                newsLetter: function() {


                    const $this = this;
                    var email = this.emailnews;
                    var user_agent = navigator.userAgent;


                    if(!email || !$this.validarEmail(email)) {
                        this.emailnews = "E-mail inválido";
                    }

                    // ok - ajax salvar mail
                    else {

                        $.ajax({
                            url: Yii.app.createUrl('maillings/create'),
                            data: {email: email, user_agent: user_agent},
                            type: 'post',

                            success: function(resp) {

                                // msg de sucesso
                                if(resp.trim() == '1') {
                                   $this.emailnews = "E-mail cadastrado com sucesso!";
                                }

                                else if(resp.trim() == '-3') {
                                    $this.emailnews = "E-mail já está cadastrado!";
                                }

                                else {
                                    $this.emailnews = "Erro ao enviar o email";
                                }


                            },

                            error: function(x, h, z) {
                                
                            }
                        });
                    }
                }
            }
        });
       
        
    </script>

    <script>
        $(document).ready(function(){

            $(".btn-pausar").on("click", function(e) {
                e.preventDefault();
                var id = $(this).data("id");

                var s = confirm("Confirmar ação?");

                if(s) {

                    $.ajax({
                        url: Yii.app.createUrl('embarcacoes/desativarOuPausarAnuncio', {id: id}),
                        type: "POST",
                        data: {},
                        success: function(resp) {
                            if(resp.trim() == "1") {
                                location.reload();
                            }
                        },
                        error: function() {
                            alert("Erro inesperado. Contate o admin do sistema");
                        }
                    });    
                }
            });

            $(".btn-excluir").on("click", function(e) {
                e.preventDefault();
                var id = $(this).data("id");

                var s = confirm("Ao efetuar esta operação seu anúncio deixará de aparecer nas buscas do Bombarco. Confirmar?");

                if(s) {

                    $.ajax({
                        url: Yii.app().createUrl('embarcacoes/deletarAnuncio', {id: id}),
                        type: "POST",
                        data: {},
                        success: function(resp) {
                            if(resp.trim() == "1") {
                                location.reload();
                            }
                        },
                        error: function() {
                            alert("Erro inesperado. Contate o admin do sistema");
                        }
                    });    
                }
            });

               /* Executa a requisição quando o campo CEP perder o foco */
            $('#Usuarios_cep').blur(function () {

                /* Configura a requisição AJAX */
                $.ajax({
                    url: Yii.app.createUrl('anuncios/consultarCep'), /* URL que será chamada */
                    type: 'POST', /* Tipo da requisição */

                    //data: 'cep=' + $('#Empresas_cep').val(), /* dado que será enviado via POST */
                    data: {cep: $("#Usuarios_cep").val()},
                    dataType: 'json', /* Tipo de transmissão */
                    success: function (data) {

                        if (data.sucesso == 1) {

                            $('#Usuarios_endereco').val(data.rua);
                            $('#Usuarios_bairro').val(data.bairro);
                            $('#Usuarios_numero').focus();
                        }
                    }
                });

            });

            var maskBehavior = function (val) {
                return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
            },
            options = {onKeyPress: function (val, e, field, options) {
                    field.mask(maskBehavior.apply({}, arguments), options);
                }
            };

            $("#Usuarios_cpf").mask("999.999.999-99");
            $("#Usuarios_telefone").mask("(99) 9999-9999");
            $("#Usuarios_cnpj").mask('99.999.999/9999-99');

            $("#celular").mask(maskBehavior, options);
            $("#Usuarios_data_nascimento").mask("99/99/9999");

            // ajax preencher cidades a partir do estado
            $("#Usuarios_estados_id").on("change", function () {

                var estado_id = $(this).val();

                $.ajax({
                    url: Yii.app.createUrl('utils/loadCities2'),
                    type: 'post',
                    data: {estados_id: estado_id},
                    success: function (resp) {

                        $("#Usuarios_cidades_id").empty();
                        var selectDefault = $('<option selected="selected" value="">selecione</option>');
                        $("#Usuarios_cidades_id").append(selectDefault).trigger("create");
                        var cidades = JSON.parse(resp.trim());

                        for (var i = 0; i < cidades.length; i++) {

                            var option = $('<option value="' + cidades[i].id + '">' + cidades[i].nome + '</option>');
                            $("#Usuarios_cidades_id").append(option).trigger("create");
                        }
                    },
                    error: function (x, h, z) {

                    }
                });
            });


            $("#atualizar-dados-pessoais").on("click", function (e) {
                e.preventDefault();

                if($("#Usuarios_cpf").val() == "") {
                    $("#Usuarios_cpf").css("border-color", "red");
                    return false;
                }

                var id = $("#idUsuario").val();

                $.ajax({
                    url: Yii.app.createUrl('usuarios/atualizarDadosPessoais/' + id),
                    type: 'post',
                    data: $("#form-atualizar-dados").serialize(),
                    success: function (resp) {

                        if (resp.trim() != '1') {
                            alert("Ocorreu um erro inesperado. Tente mais tarde");
                        }
                        else {

                            $("#campos-pf-liberado").fadeOut("fast");
                            $("#campos-pf-travado").fadeIn("fast");
                            alert("Dados alterados com sucesso");
                            location.reload();

                        }
                    },
                    error: function (x, h, z) {
                        alert("Ocorreu um erro inesperado. Tente mais tarde");
                    }
                });

            });


            $("#remover-logo").on("click", function (e) {

                e.preventDefault();

                $.ajax({    
                    url: Yii.app.createUrl('usuarios/alterarLogo'),
                    type: 'post',
                    data: {
                        excluirlogo: 1
                    },
                    success: function (resp) {

                        $("#logo-img").attr("src", Yii.app.createUrl('public/usuarios/addfoto.png'));
                        $("#remover-logo").hide();
                        location.reload();

                    },
                    error: function (x, h, z) {
                        alert("Ocorreu um erro inesperado. Tente novamente mais tarde");
                    }
                });
            });

            $("#logo-img, #btn-editar-logo").on("click", function (e) {
                e.preventDefault();
                $("#logo-file").trigger("click");
            });

            $('#logo-file').on("change", function () {

                var nome = $(this)[0].files[0].name;

                var fd = new FormData();
                fd.append("logo", $(this)[0].files[0]);

                $.ajax({
                    url: Yii.app.createUrl('usuarios/alterarLogo'),
                    type: 'POST',
                    cache: false,
                    data: fd,
                    processData: false,
                    contentType: false,
                    success: function (resp) {


                        if (resp.trim() == "-1") {
                           alert("Foto não permitida ou ultrapassou o limite! Formatos aceitos: JPEG / PNG . Tamanho Máximo 1 MB - Prefira Imagens na horizontal.");
                        }

                        else {

                            $("#logo-img").attr("src", Yii.app.createUrl('public/usuarios/' + resp.trim()));

                        }


                    },
                    error: function (x, h, z) {
                        alert("Ocorreu um erro inesperado. Tente novamente mais tarde");
                    }
                });
            });
        });
    </script>
</html>
