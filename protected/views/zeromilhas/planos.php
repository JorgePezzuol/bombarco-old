<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="author" content="Bombarco - Líder em Negócios Náuticos" />
  <meta name="keywords" content="bombarco, zeromilhas, nautico, lider, marinha" />
          <meta name="geo.region" content="BR-SP" />
        <meta name="geo.placename" content="Brasil" />
        <meta name="geo.position" content="-14.2392976,-53.1805017,4z" />
        <meta name="ICBM" content="-14.2392976,-53.1805017,4z" />
        <meta name="robots" content="follow,index" />
  <link rel="shortcut icon" href="/favicon.ico?e=23" />
  <title>Catálogo Bombarco | Planos</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no" />
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/bootstrap.min.css?e=2333'); ?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/fancybox.css?e=23'); ?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/fancybox-buttons.css?e545');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/font-awesome.min.css?e1');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/tether.min.css?1212');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/reset.css');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/bjqs.css?e=234');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/style.css?e=22223');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/responsive.css?e=3333f');?>
  <?php Yii::app()->getClientScript()->registerCssFile(Yii::app()->baseUrl . '/css/zeromilhas/jquery-ui.css?e=234');?>

  

  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/modernizr.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery-3.2.1.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/tether.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/bootstrap.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/counter.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/numeral.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/fancybox.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/fancybox-buttons.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery.ez-plus.js?e=2344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery-ui.js?e=1111', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/owl.carousel.min.js?e=1344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/bjqs.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/maskedinput.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/bootstrap-slider.min.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/modernizr.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/scripts.js?e=123', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/vue-2.5.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/axios-0.17.js?e=344', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/js_zeromilhas/jquery.lightbox_me.js', CClientScript::POS_END); ?>
  <?php Yii::app()->getClientScript()->registerScriptFile(Yii::app()->baseUrl . '/js/jquery-mask.js', CClientScript::POS_END); ?>

<!-- Permite que o IE interprete as tags do HTML 5 -->
<!--[if lt IE 9]>
<script src="media/http://html5shim.googlecode.com/svn/trunk/html5.js?e=344"></script>
<link rel="stylesheet" type="text/css" href="http://domain.tld/path/ie-specific.css" />
<![endif]-->

<!--Fonts-->
<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,600,800,900" rel="stylesheet">

    <?php
        $this->renderPartial('analytics');
    ?>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

</head> <!-- FIM HEAD -->

<body id="topo" class="side-collapse-container">

    <div id="app">

   <?php
        $this->renderPartial('_menu');
    ?>


  <section id="titulo-subpagina">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 col-sm-12">
          <h1>
            <small>minhas</small>
            Embarcações
            <img src="<?php echo Yii::app()->baseUrl . '/img_zeromilhas/icones/ico_titulo.png'?>" alt="Titulo" />
          </h1>
          <p>Confira as embarcações que você têm anunciadas.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Miolo -->
  <section id="miolo">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 col-sm-12">
             <ul class="nav nav-pills mb-3" id="menu-tabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link" id="perfil-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/perfil", array("id"=>Yii::app()->user->id)); ?>" aria-controls="tab-perfil" aria-selected="true">Perfil</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" id="embarcacoes-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/planos"); ?>" aria-controls="tab-embarcacoes" aria-selected="false">Meus Modelos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="embarcacoes-tab" href="<?php echo Yii::app()->createUrl("embarcacoes/lista?v=0&e=anuncios"); ?>" aria-controls="tab-embarcacoes" aria-selected="false"> Classificados</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="dashboard-tab" href="<?php echo Yii::app()->createUrl("dashboard"); ?>" aria-controls="tab-dashboard" aria-selected="false">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="mensagens-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/mensagens"); ?>" aria-controls="tab-mensagens" aria-selected="false">Mensagens</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="mensagens-tab" href="<?php echo Yii::app()->createUrl("zeromilhas/pagamento"); ?>" aria-controls="tab-mensagens" aria-selected="false">Pagamentos</a>
            </li>

            
          </ul>
          <div class="tab-content" id="pills-tabContent">

                <?php foreach($planos as $p): ?>

                    <br/><br/>

                    <?php


                        $criteria = new CDbCriteria;
                        $criteria->condition = "plano_usuarios_id=:plano_usuarios_id";
                        $criteria->order = "status asc";
                        $criteria->params = array(":plano_usuarios_id"=>$p->id);
                        $embarcacoes = Embarcacoes::model()->findAll($criteria);  

                    ?>

                    <?php //$embarcacoes = Embarcacoes::model()->findAll("plano_usuarios_id=:plano_usuarios_id", array(":plano_usuarios_id"=>$p->id)); ?>

                    <div class="row filtros embarcacoes">
                        <?php if(count($embarcacoes) > 0): ?>
                            <div class="col-lg-12 col-sm-12" style="margin-top: -50px;">
                        <?php else: ?>
                            <div class="col-lg-12 col-sm-12">
                        <?php endif; ?>
                        
                          <div class="row">
                            <div class="col-lg-4 col-sm-12">
                              <h4>
 
                                <?php if($p->planos->flag == "plano_estaleiro"): ?>  
                                    <b>Plano de catálogo</b>
                                    <?php $tipo = "estaleiro"; ?>
                                <?php else: ?>
                                    <b>Plano de classificados</b>
                                    <?php $tipo = "plano"; ?>
                                <?php endif; ?>
                                
                              </h4>
                            </div>

                            <?php if(PlanoUsuarios::qtdeAnunciosCadastrados($p) < $p->qntpermitida): ?>
                                <div class="col-lg-3 col-sm-12 col-md-6 ajusta-altura">
                                  <a target="_blank" class="btn btn-padrao-branco borda-cinza" href="<?php echo Yii::app()->createUrl("anuncios/anunciarEmbarcacao?tipo_anuncio=".$tipo."&id_plano=".$p->id); ?>"> adicionar embarcações </a>
                                </div>
                            <?php else: ?>
                                <div class="col-lg-3 col-sm-12 col-md-6 ajusta-altura">
                                </div>
                            <?php endif; ?>

                            <?php if(PlanoUsuarios::verSePodeRenovar($p) == true): ?>
                                <div class="col-lg-3 col-md-6 col-sm-12">
                                  <a class="btn btn-verde w-100" href="<?php echo Yii::app()->createUrl('/planoUsuarios/upgradePlano', array('id' => $p->id)); ?>" ><span class="pull-left">renovar plano </span><i class="fa fa-angle-right"></i></a>
                                </div>
                            <?php else: ?>
                                <div class="col-lg-3 col-md-6 col-sm-12">
                                </div>
                            <?php endif; ?>


                          </div>
                        </div>
                        <div class="col-lg-12 col-sm-12">
                          <div class="bg-faded no-padding">
                            
                            <p class="escolha">
                                O seu plano de <b><?php echo $p->qntpermitida; ?> embarcações</b>por<b><?php echo $p->planos->duracaomeses;?> meses</b>está 
                                <?php if($p->status == 2): ?>
                                    <strong>
                                        <i class="fa fa-circle ativo"></i> <?php echo Anuncio::$_status_anuncio_by_number[$p->status];?>
                                    </strong>
                                <?php else: ?>
                                    <strong>
                                        <i class="fa fa-circle pendente"></i> <?php echo Anuncio::$_status_anuncio_by_number[$p->status];?>
                                    </strong>
                                <?php endif;?>
                            </p>

                            

                            <?php foreach($embarcacoes as $emb): ?>
                                <div class="status-embarcacao">
                                  <div class="row">
                                    <div class="col-lg-2 col-sm-12">
                                      <img src="<?php echo EmbarcacaoImagens::obterImgPrincipalAbs($emb->id); ?>" alt="Espaço para Imagem" />
                                    </div>
                                    <div class="col-lg-4 col-sm-5">
                                      <span>Marca: </span>
                                      <p><?php echo $emb->embarcacaoFabricantes->titulo; ?></p>
                                      <span>Modelo:</span>
                                      <p><?php echo $emb->embarcacaoModelos->titulo; ?></p>
                                      <?php if($emb->ano != null): ?>
                                        <span>Ano:</span>
                                        <p><?php echo $emb->ano; ?></p>
                                      <?php endif; ?>
                                    </div>
                                    <div class="col-lg-6 col-sm-7">
                                        <?php if($emb->status == 2): ?>
                                        <h3>Status: <i class="fa fa-circle ativo"></i></h3>
                                        <ul class="lista-status">
                                            <li style="font-weight:500; color:#102e46;"><?php echo Anuncio::$_status_anuncio_by_number[$emb->status];?></li>
                                        </ul>
                                        <?php else: ?>
                                            <h3>Status: <i class="fa fa-circle pendente"></i></h3>
                                            <ul class="lista-status">
                                                <li style="font-weight:500; color:#102e46;"><?php echo Anuncio::$_status_anuncio_by_number[$emb->status];?></li>
                                            </ul>
                                        <?php endif; ?>
                                      <div class="form-inline">
                                        <a target="_blank" href="<?php echo Embarcacoes::mountUrl($emb); ?>" class="btn btn-padrao-branco borda-cinza">Ver Anúncio</a>
                                        <?php if($emb->status != Anuncio::$_status_anuncio['ANUNCIO_VENDIDO'] && $emb->status != Anuncio::$_status_anuncio['ANUNCIO_DELETADO']): ?>
                                            <a target="_blank" href="<?php echo Yii::app()->createUrl("embarcacoes/update", array("id"=>$emb->id)); ?>" class="btn btn-padrao-branco borda-cinza">Editar</a>
                                            <?php if($emb->status == Anuncio::$_status_anuncio['ANUNCIO_PAUSADO']): ?>
                                                <a href="#" class="btn btn-padrao-branco borda-cinza btn-editar btn-pausar" data-id="<?php echo $emb->id;?>">Despausar</a>
                                                
                                            <?php elseif($emb->status == Anuncio::$_status_anuncio['ANUNCIO_ATIVADO']): ?>
                                                <a href="#" class="btn btn-padrao-branco borda-cinza btn-editar btn-pausar" data-id="<?php echo $emb->id;?>">Pausar</a>
                                            <?php else: ?>
                                            <?php endif;?>
                                            <a href="#" class="btn btn-padrao-branco borda-cinza btn-excluir" data-id="<?php echo $emb->id;?>">Excluir</a>
                                        <?php endif; ?>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                            <?php endforeach; ?>
                            

                          </div>
                        </div>
                    </div>
                <?php endforeach; ?>
            </div>
            <div class="tab-pane fade" id="tab-dashboard" role="tabpanel" aria-labelledby="pills-contact-tab">
              gsddfgddfhhfghfg
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


<a href="#topo" class="volta-topo" title="Topo"><i class="fa fa-angle-up"></i></a>


</body>


    <script>
        $(document).ready(function(){

            $(".btn-pausar").on("click", function(e) {
                e.preventDefault();
                var id = $(this).data("id");

                var s = confirm("Confirmar ação?");

                if(s) {

                    $.ajax({
                        url: Yii.app.createUrl('embarcacoes/desativarOuPausarAnuncio2', {id: id}),
                        type: "POST",
                        data: {},
                        success: function(resp) {
                            if(resp.trim() == "1") {
                                location.reload();
                            }
                        },
                        error: function() {
                            alert("Erro inesperado. Contate o admin do sistema");
                        }
                    });    
                }
            });

            $(".btn-excluir").on("click", function(e) {
                e.preventDefault();
                var id = $(this).data("id");

                var s = confirm("Ao efetuar esta operação seu anúncio deixará de aparecer nas buscas do Bombarco. Confirmar?");

                if(s) {

                    $.ajax({
                        url: Yii.app.createUrl('embarcacoes/deletarAnuncio'),
                        type: "GET",
                        data: {
                          embarcacoes_id: id
                        },
                        success: function(resp) {
                            if(resp.trim() == "1") {
                                setTimeout(function(){ location.reload(); }, 2000);
                                

                            }
                        },
                        error: function() {
                            alert("Erro inesperado. Contate o admin do sistema");
                        }
                    });    
                }
            });

               /* Executa a requisição quando o campo CEP perder o foco */
            $('#Usuarios_cep').blur(function () {

                /* Configura a requisição AJAX */
                $.ajax({
                    url: Yii.app.createUrl('anuncios/consultarCep'), /* URL que será chamada */
                    type: 'POST', /* Tipo da requisição */

                    //data: 'cep=' + $('#Empresas_cep').val(), /* dado que será enviado via POST */
                    data: {cep: $("#Usuarios_cep").val()},
                    dataType: 'json', /* Tipo de transmissão */
                    success: function (data) {

                        if (data.sucesso == 1) {

                            $('#Usuarios_endereco').val(data.rua);
                            $('#Usuarios_bairro').val(data.bairro);
                            $('#Usuarios_numero').focus();
                        }
                    }
                });

            });

            var maskBehavior = function (val) {
                return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
            },
            options = {onKeyPress: function (val, e, field, options) {
                    field.mask(maskBehavior.apply({}, arguments), options);
                }
            };

            $("#Usuarios_cpf").mask("999.999.999-99");
            $("#Usuarios_telefone").mask("(99) 9999-9999");
            $("#Usuarios_cnpj").mask('99.999.999/9999-99');

            $("#celular").mask(maskBehavior, options);
            $("#Usuarios_data_nascimento").mask("99/99/9999");

            // ajax preencher cidades a partir do estado
            $("#Usuarios_estados_id").on("change", function () {

                var estado_id = $(this).val();

                $.ajax({
                    url: Yii.app.createUrl('utils/loadCities2'),
                    type: 'post',
                    data: {estados_id: estado_id},
                    success: function (resp) {

                        $("#Usuarios_cidades_id").empty();
                        var selectDefault = $('<option selected="selected" value="">selecione</option>');
                        $("#Usuarios_cidades_id").append(selectDefault).trigger("create");
                        var cidades = JSON.parse(resp.trim());

                        for (var i = 0; i < cidades.length; i++) {

                            var option = $('<option value="' + cidades[i].id + '">' + cidades[i].nome + '</option>');
                            $("#Usuarios_cidades_id").append(option).trigger("create");
                        }
                    },
                    error: function (x, h, z) {

                    }
                });
            });


            $("#atualizar-dados-pessoais").on("click", function (e) {
                e.preventDefault();

                if($("#Usuarios_cpf").val() == "") {
                    $("#Usuarios_cpf").css("border-color", "red");
                    return false;
                }

                var id = $("#idUsuario").val();

                $.ajax({
                    url: Yii.app.createUrl('usuarios/atualizarDadosPessoais/' + id),
                    type: 'post',
                    data: $("#form-atualizar-dados").serialize(),
                    success: function (resp) {

                        if (resp.trim() != '1') {
                            alert("Ocorreu um erro inesperado. Tente mais tarde");
                        }
                        else {

                            $("#campos-pf-liberado").fadeOut("fast");
                            $("#campos-pf-travado").fadeIn("fast");
                            alert("Dados alterados com sucesso");
                            location.reload();

                        }
                    },
                    error: function (x, h, z) {
                        alert("Ocorreu um erro inesperado. Tente mais tarde");
                    }
                });

            });


            $("#remover-logo").on("click", function (e) {

                e.preventDefault();

                $.ajax({    
                    url: Yii.app.createUrl('usuarios/alterarLogo'),
                    type: 'post',
                    data: {
                        excluirlogo: 1
                    },
                    success: function (resp) {

                        $("#logo-img").attr("src", Yii.app.createUrl('public/usuarios/addfoto.png'));
                        $("#remover-logo").hide();
                        location.reload();

                    },
                    error: function (x, h, z) {
                        alert("Ocorreu um erro inesperado. Tente novamente mais tarde");
                    }
                });
            });

            $("#logo-img, #btn-editar-logo").on("click", function (e) {
                e.preventDefault();
                $("#logo-file").trigger("click");
            });

            $('#logo-file').on("change", function () {

                var nome = $(this)[0].files[0].name;

                var fd = new FormData();
                fd.append("logo", $(this)[0].files[0]);

                $.ajax({
                    url: Yii.app.createUrl('usuarios/alterarLogo'),
                    type: 'POST',
                    cache: false,
                    data: fd,
                    processData: false,
                    contentType: false,
                    success: function (resp) {


                        if (resp.trim() == "-1") {
                           alert("Foto não permitida ou ultrapassou o limite! Formatos aceitos: JPEG / PNG . Tamanho Máximo 1 MB - Prefira Imagens na horizontal.");
                        }

                        else {

                            $("#logo-img").attr("src", Yii.app.createUrl('public/usuarios/' + resp.trim()));

                        }


                    },
                    error: function (x, h, z) {
                        alert("Ocorreu um erro inesperado. Tente novamente mais tarde");
                    }
                });
            });
        });
    </script>
    <script>
        
        var perfil = new Vue({ 
            delimiters: ['${', '}'],
            el: "#app",
            data: {
                emailnews: ""
            },
            created: function() {

            },

            mounted: function() {

            },
            methods: {
                newsLetter: function() {


                    const $this = this;
                    var email = this.emailnews;
                    var user_agent = navigator.userAgent;


                    if(!email || !$this.validarEmail(email)) {
                        this.emailnews = "E-mail inválido";
                    }

                    // ok - ajax salvar mail
                    else {

                        $.ajax({
                            url: Yii.app.createUrl('maillings/create'),
                            data: {email: email, user_agent: user_agent},
                            type: 'post',

                            success: function(resp) {

                                // msg de sucesso
                                if(resp.trim() == '1') {
                                   $this.emailnews = "E-mail cadastrado com sucesso!";
                                }

                                else if(resp.trim() == '-3') {
                                    $this.emailnews = "E-mail já está cadastrado!";
                                }

                                else {
                                    $this.emailnews = "Erro ao enviar o email";
                                }


                            },

                            error: function(x, h, z) {
                                
                            }
                        });
                    }
                }
            }
        });
       
        
    </script>
</html>
